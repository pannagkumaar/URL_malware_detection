def urlscan_scan(url_to_scan, api_key):
    console = Console()
    def printc(message, style=None):
        if style:
            console.print(message, style=style)
        else:
            console.print(message)
    def process_urlscan_response(response_json):
        verdict_overall = response_json['verdicts']['overall']
        verdict_urlscan = response_json['verdicts']['urlscan']

        if verdict_overall['score'] > 0:
            printc(f"\n[green3][-][/green3]\nVerdict overall\n{'-'*20}")
            printc(f"[green3][-][/green3]\nTime: {response_json['task']['time']}")
            
            for verdict_overall_property, verdict_overall_value in verdict_overall.items():
                if isinstance(verdict_overall_value, list):
                    printc(f"[gold][!][/gold]{verdict_overall_property}:  {verdict_overall_value[0]}")
                else:
                    printc(f"[gold][!][/gold]{verdict_overall_property}:  {verdict_overall_value}")

            
            printc(f"\n[green3][-][/green3]\nVerdict urlscan\n{'-'*20}")
            for verdict_urlscan_property, verdict_urlscan_value in verdict_urlscan.items():
                if isinstance(verdict_urlscan_value, list):
                    if verdict_urlscan_property == 'brands':
                        for brand_key, brand_value in verdict_urlscan_value[0].items():
                            if brand_value != "":
                                print(f"[gold][!][/gold]{brand_key}:  {brand_value}")
                            else:
                                print(f"[-]{brand_key}:  N/A")
                else:
                    if verdict_urlscan_property in ['score', 'malicious']:
                        print(f"[gold][!][/gold]{verdict_urlscan_property}:  {verdict_urlscan_value}")

            printc(f"[gold][!][/gold] For more information about the report, you can check the link below ↓")
            printc(f"[green3][-][/green3]{response_json['task']['reportURL']}")
        else:
            printc(f"\n[gold][!][/gold] Verdict urlscan\n{'-'*20}")
            printc(f"[gold][!][/gold] Score: {verdict_urlscan['score']}")
            printc(f"[gold][!][/gold] Malicious: {verdict_urlscan['malicious']}")
            
            printc(f"\n[gold][!][/gold] Verdict Overall\n{'-'*20}")
            printc(f"[gold][!][/gold] Score: {verdict_overall['score']}")
            printc(f"[gold][!][/gold] Malicious: {verdict_overall['malicious']}")
            
            printc(f"[green3][-][/green3] For more information about the report, you can check the link below ↓")
            printc(f"[green3][-][/green3]{response_json['task']['reportURL']}")
